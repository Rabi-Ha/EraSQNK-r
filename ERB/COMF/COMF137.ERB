@COM137
;확장벌룬

PRINTL 확장벌룬

CALL TRAIN_MESSAGE_B

SIF REFUSE_CHECK()
	RETURN 0

STR:0 = 확장벌룬

RETURN 1

@FLAG_COM137, ARG

@SOURCE_COM137, ARG
#DIM USE_EXP
#DIM USE_ABL
VARSET LOCAL

LOCAL:20 += 50
LOCAL:21 += 100

LOCAL:6 = 400
LOCAL:9 = 1000
LOCAL:11 = 1000
LOCAL:12 = 1000
LOCAL:13 = 1000
LOCAL:14 = 3000

IF TEQUIP:확장벌룬
	IF TEQUIP:확장벌룬 == 1
		USE_ABL = ABL:Ｖ감각
		USE_EXP = EXP:Ｖ확장경험
	ELSE
		USE_ABL = ABL:Ａ감각
		USE_EXP = EXP:Ａ확장경험
	ENDIF

	;ABL:ＡorＶ감각をみる
	SELECTCASE USE_ABL
	CASE 0
		LOCAL:(TEQUIP:확장벌룬) = 10
	CASE 1
		LOCAL:(TEQUIP:확장벌룬) = 30
	CASE 2
		LOCAL:(TEQUIP:확장벌룬) = 300
	CASE 3
		LOCAL:(TEQUIP:확장벌룬) = 600
		LOCAL:3 = 200
	CASE 4
		LOCAL:(TEQUIP:확장벌룬) = 900
		LOCAL:3 = 450
	CASEELSE
		LOCAL:(TEQUIP:확장벌룬) = 1200
		LOCAL:3 = 750
	ENDSELECT

	IF TEQUIP:확장벌룬 == 1
		;정조관념
		IF TALENT:정조관념
			IF TALENT:처녀 == 1
				LOCAL:14 += 10000
				LOCAL:15 += 3000
			ENDIF
		;정조관결여
		ELSEIF TALENT:정조관결여
			IF TALENT:처녀 == 1
				LOCAL:14 += 1000
				LOCAL:15 += 500
			ENDIF
		ELSEIF TALENT:처녀 == 1
			LOCAL:14 += 3000
			LOCAL:15 += 1000
		ENDIF
	;Ａ민감, 둔감をみる
	ELSE
		;쾌Ａ自体の체크は後でまとめてやる
		IF TALENT:Ａ둔감
			TIMES LOCAL:6, 0.50
			TIMES LOCAL:11, 0.50
			TIMES LOCAL:13, 0.50
			TIMES LOCAL:14, 0.50
		ELSEIF TALENT:Ａ민감
			TIMES LOCAL:6, 1.50
			TIMES LOCAL:11, 1.50
			TIMES LOCAL:13, 1.50
			TIMES LOCAL:14, 1.50
		ENDIF

		;처녀で정조관념or엉덩이許可플래그
		IF (TALENT:처녀 == 1 && TALENT:정조관념) || CFLAG:100
			LOCAL:14 /= 3
			LOCAL:15 /= 3
		ENDIF
	ENDIF

	;확장경험に応じた快感, 고통, 공포, 일탈(반감)보정
	SELECTCASE USE_EXP
	CASE IS >= 300
		TIMES LOCAL:6, 0.50
		TIMES LOCAL:9, 0.20
		TIMES LOCAL:14, 0.20
	CASE IS >= 150
		TIMES LOCAL:6, 0.60
		TIMES LOCAL:9, 0.40
		TIMES LOCAL:14, 0.60
	CASE IS >= 50
		TIMES LOCAL:6, 0.80
		TIMES LOCAL:9, 0.70
	CASE IS >= 20
		TIMES LOCAL:14, 1.20
	CASE IS >= 5
		TIMES LOCAL:(TEQUIP:확장벌룬), 0.50
		TIMES LOCAL:6, 1.50
		TIMES LOCAL:9, 1.50
		TIMES LOCAL:14, 1.50
	CASEELSE
		TIMES LOCAL:(TEQUIP:확장벌룬), 0.10
		TIMES LOCAL:6, 2.00
		TIMES LOCAL:9, 2.00
		TIMES LOCAL:14, 2.00
	ENDSELECT
ENDIF

;PALAM:욕정をみる
SELECTCASE PALAM:욕정
CASE IS < PALAMLV:1
	TIMES LOCAL:13, 0.60
CASE IS < PALAMLV:2
	TIMES LOCAL:13, 0.80
CASE IS < PALAMLV:3
	TIMES LOCAL:13, 1.00
CASE IS < PALAMLV:4
	TIMES LOCAL:13, 1.20
CASE IS >= PALAMLV:4
	TIMES LOCAL:13, 1.40
ENDSELECT

;ABL:마조끼をみる
SELECTCASE ABL:마조끼
CASE 0
	TIMES LOCAL:9, 2.00
	TIMES LOCAL:11, 0.00
	TIMES LOCAL:13, 1.50
	TIMES LOCAL:14, 2.00
CASE 1
	TIMES LOCAL:9, 1.50
	TIMES LOCAL:11, 0.10
	TIMES LOCAL:13, 1.20
	TIMES LOCAL:14, 1.50
CASE 2
	TIMES LOCAL:11, 0.40
CASE 3
	TIMES LOCAL:9, 0.50
	TIMES LOCAL:11, 0.80
	TIMES LOCAL:13, 0.70
	TIMES LOCAL:14, 0.70
CASE 4
	TIMES LOCAL:9, 0.20
	TIMES LOCAL:11, 1.20
	TIMES LOCAL:13, 0.60
	TIMES LOCAL:14, 0.40
CASEELSE
	TIMES LOCAL:9, 0.05
	TIMES LOCAL:11, 1.50
	TIMES LOCAL:13, 0.30
	TIMES LOCAL:14, 0.10
ENDSELECT

CALL SOURCE_SMPLAY, "확장벌룬", ARG

CALL CALC, "조교소스", LOCAL:0, LOCAL:1, LOCAL:2, LOCAL:3, LOCAL:4, LOCAL:5, LOCAL:6, LOCAL:7, LOCAL:8, LOCAL:9, LOCAL:10, LOCAL:11, LOCAL:12, LOCAL:13, LOCAL:14, LOCAL:15, LOCAL:16, LOCAL:17, LOCAL:18, LOCAL:19, LOCAL:20, LOCAL:21, ARG


@TRAIN_MESSAGE_COM137
;확장벌룬の着脱
IF TEQUIP:확장벌룬
	IF TEQUIP:확장벌룬 == 1
		LOCAL = 23
		LOCALS = 질구
	ELSE
		LOCAL = 26
		LOCALS = 항문
	ENDIF
	PRINTFORML 벌룬에서 공기를 빼고, %CALLNAME:TARGET%의 벌어진 구멍에서 빼내었다
	IF TEQUIP:확장벌룬 == 1 && BASE:요의 >= 30000 && TALENT:여자
		PRINTFORML …몰래 뇨의를 견디고 있던 %조사처리(CALLNAME:TARGET,"는")%, 요도의 압박감을 잃고 동시에 오줌을 흘려버렸다
		CALL EVENT_OMORASHI, 2
		PRINTL 
	ELSEIF TEQUIP:확장벌룬 == 2 && TEQUIP:관장
		CALL SETFLAG, "배설"
		PRINTL 
	ENDIF
	IF ABL:LOCAL >= 6
		PRINTFORMW %조사처리(CALLNAME:TARGET,"는")%, 자신의 %조사처리(LOCALS,"를")% 주욱 벌리며, 황홀해하고 있다…
	ELSEIF ABL:LOCAL == 5
		PRINTFORMW %CALLNAME:TARGET%의 벌려진 %조사처리(LOCALS,"를")% 통해, 뱃속이 훤히 보이고 있다…
	ELSEIF ABL:LOCAL == 4
		PRINTFORMW %CALLNAME:TARGET%의 %조사처리(LOCALS,"는")%, 펼쳐진 채로 좀처럼 돌아오지 않는다…
	ELSEIF ABL:LOCAL == 3
		PRINTFORMW %CALLNAME:TARGET%의 %조사처리(LOCALS,"는")%, 뻥하고 입을 열고 있다…
	ELSEIF ABL:LOCAL == 2
		PRINTFORMW %CALLNAME:TARGET%의 %조사처리(LOCALS,"는")%, 씰룩거리며 천천히 닫히고 있다…
	ELSE
		PRINTFORMW %CALLNAME:TARGET%의 %조사처리(LOCALS,"는")%, 천천히 닫히고 있다…
	ENDIF
	TEQUIP:확장벌룬 = 0
ELSE
	;どっちを확장するか선택
	CALL SELECT_BALLOON

	SIF REFUSE_CHECK()
		RETURN 0

	IF TEQUIP:확장벌룬 == 1
		PRINTFORMW %CALLNAME:TARGET%의 질에 에어벌룬을 삽입하고, 공기를 넣었다…
	ELSE
		IF COND("액체관장")
			PRINTFORMW %CALLNAME:TARGET%의 관장액이 주입된 항문을, 부풀려진 벌룬으로 꽉 막았다…
		ELSE
			PRINTFORMW %CALLNAME:TARGET%의 애널에 에어벌룬을 삽입하고, 공기를 넣었다…
		ENDIF
	ENDIF
ENDIF

@SELECT_BALLOON
VARSET LOCAL
SIF USE_V(TARGET) && TALENT:처녀 == 0 && TALENT:Ｖ손상 == 0 && ABL:Ｖ확장
	LOCAL:0 = 1
SIF USE_A(TARGET) && TALENT:Ａ손상 == 0 && ABL:Ａ확장
	LOCAL:1 = 1
IF LOCAL:0 && LOCAL:1
	PRINTFORML 어느 쪽 구멍을 벌룬으로 확장합니까? 
	PRINTFORML (빵빵해질때까지 벌리기 때문에, 양구멍 동시는 무리입니다)
	PRINTFORML  [ 0] 질
	PRINTFORML  [ 1] 항문
	PRINTFORML [100] 그만둔다
	CALL INPUT_SELECT, 2, 100
ELSEIF LOCAL:0
	RESULT = 0
ELSE
	RESULT = 1
ENDIF

IF RESULT == 100
	TEQUIP:확장벌룬 = 0
	TFLAG:14 = 1
	RETURN 0
ELSEIF RESULT == 0
	TEQUIP:확장벌룬 = 1
ELSEIF RESULT == 1
	TEQUIP:확장벌룬 = 2
ENDIF

RETURN 1


@EQUIP_COM48
SIF SELECTCOM == 137
	RETURN 0
;확장벌룬
CALL SOURCE_COM137, 30

RETURN 1

@EQUIP_COM48_2
SIF SELECTCOM == 137
	RETURN 0
;확장벌룬
PRINTL ＜확장벌룬 삽입 중＞
IF TEQUIP:확장벌룬 == 1
	LOCAL = 0
	LOCAL:1 = 53
ELSEIF TEQUIP:확장벌룬 == 2
	LOCAL = 1
	LOCAL:1 = 57
ENDIF
EXP:LOCAL += 1
PRINTFORML %EXPNAME:LOCAL%＋１
EXP:(LOCAL:1) += 1
PRINTFORML %EXPNAME:(LOCAL:1)%＋１

RETURN 1
